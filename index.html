<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Генератор стилизованного текста</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Все стили остаются такими же как в вашем коде */
        /* Я только добавил/изменил следующие стили: */
        
        /* Исправленное отображение пузырькового текста */
        .bubble {
            display: inline-block;
            background: linear-gradient(145deg, #6a11cb, #2575fc);
            color: white;
            padding: 2px 8px;
            margin: 0 2px;
            border-radius: 12px;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            line-height: 1.4;
            font-size: 1.1rem; /* Добавлено */
            font-family: inherit; /* Добавлено */
        }
        
        /* Исправленное отображение квадратного текста */
        .square {
            display: inline-block;
            background: #4a5568;
            color: white;
            padding: 0 5px;
            margin: 0 1px;
            border-radius: 4px;
            line-height: 1.4;
            font-size: 1.1rem; /* Добавлено */
            font-family: inherit; /* Добавлено */
            height: 24px; /* Добавлено */
            min-width: 24px; /* Добавлено */
            text-align: center; /* Добавлено */
        }
        
        /* Стиль для надстрочного текста */
        .superscript {
            vertical-align: super;
            font-size: 0.8em;
            font-family: inherit; /* Добавлено */
        }
        
        /* Улучшенное отображение невидимого текста */
        .invisible-placeholder {
            color: #718096;
            font-style: italic;
            position: relative;
        }
        
        .invisible-placeholder::after {
            content: "[Невидимый текст]";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            text-align: center;
            color: #718096;
        }
        
        /* Остальные стили остаются без изменений */
    </style>
</head>
<body>
    <!-- HTML остается таким же как в вашем коде -->

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // ... ваш существующий код ...
            
            // ИСПРАВЛЕННАЯ ФУНКЦИЯ ГЕНЕРАЦИИ ТЕКСТА
            function generateText(text, type) {
                if (!text.trim()) return '';
                
                // Обработка Zalgo текста
                if (type === 'zalgo') {
                    return generateZalgoText(text);
                }
                
                // Обработка невидимого текста
                if (type === 'invisible') {
                    return generateInvisibleText(text);
                }
                
                // Обработка контурного текста
                if (type === 'outline') {
                    return `<span class="outline-text">${text}</span>`;
                }
                
                // Обработка малых прописных
                if (type === 'smallCaps') {
                    return `<span class="small-caps">${text}</span>`;
                }
                
                // Обработка пузырькового текста (ИСПРАВЛЕНО)
                if (type === 'bubble') {
                    return text.split('').map(char => 
                        char === ' ' ? ' ' : `<span class="bubble">${char}</span>`
                    ).join('');
                }
                
                // Обработка квадратного текста (ИСПРАВЛЕНО)
                if (type === 'square') {
                    return text.split('').map(char => 
                        char === ' ' ? ' ' : `<span class="square">${char}</span>`
                    ).join('');
                }
                
                // Обработка жирного текста
                if (type === 'bold') {
                    return `<span class="bold-text">${text}</span>`;
                }
                
                // Обработка курсива
                if (type === 'italic') {
                    return `<span class="italic-text">${text}</span>`;
                }
                
                // Обработка шрифта с засечками
                if (type === 'serif') {
                    return `<span class="serif-text">${text}</span>`;
                }
                
                // Обработка шрифта без засечек
                if (type === 'sansSerif') {
                    return `<span class="sans-serif-text">${text}</span>`;
                }
                
                // Обработка староанглийского текста
                if (type === 'oldEnglish') {
                    return `<span class="old-english">${text}</span>`;
                }
                
                // Обработка текста вверх ногами
                if (type === 'upsideDown') {
                    return `<span class="upside-down">${generateUpsideDownText(text)}</span>`;
                }
                
                // Обработка надстрочного текста (ИСПРАВЛЕНО)
                if (type === 'superscript') {
                    return `<span class="superscript">${generateSuperscriptText(text)}</span>`;
                }
                
                // Базовые стили
                const effects = {
                    strike: '\u0336',    // Combining Long Stroke Overlay
                    underline: '\u0332', // Combining Low Line
                    dotted: '\u0323',    // Combining Dot Below
                    slash: '\u0337',     // Combining Short Solidus Overlay
                    double: '\u0333',    // Combining Double Low Line
                    wave: '\u0330',      // Combining Tilde Below
                };
                
                const effectChar = effects[type] || '';
                let result = '';
                
                for (let i = 0; i < text.length; i++) {
                    result += text[i] + effectChar;
                }
                
                return result;
            }
            
            // ИСПРАВЛЕННАЯ ФУНКЦИЯ НАДСТРОЧНОГО ТЕКСТА
            function generateSuperscriptText(text) {
                const superscriptMap = {
                    '0': '⁰', '1': '¹', '2': '²', '3': '³', '4': '⁴', '5': '⁵', '6': '⁶', 
                    '7': '⁷', '8': '⁸', '9': '⁹', 'a': 'ᵃ', 'b': 'ᵇ', 'c': 'ᶜ', 'd': 'ᵈ', 
                    'e': 'ᵉ', 'f': 'ᶠ', 'g': 'ᵍ', 'h': 'ʰ', 'i': 'ⁱ', 'j': 'ʲ', 'k': 'ᵏ', 
                    'l': 'ˡ', 'm': 'ᵐ', 'n': 'ⁿ', 'o': 'ᵒ', 'p': 'ᵖ', 'q': '۹', 'r': 'ʳ', 
                    's': 'ˢ', 't': 'ᵗ', 'u': 'ᵘ', 'v': 'ᵛ', 'w': 'ʷ', 'x': 'ˣ', 'y': 'ʸ', 
                    'z': 'ᶻ', 'A': 'ᴬ', 'B': 'ᴮ', 'C': 'ᶜ', 'D': 'ᴰ', 'E': 'ᴱ', 'F': 'ᶠ', 
                    'G': 'ᴳ', 'H': 'ᴴ', 'I': 'ᴵ', 'J': 'ᴶ', 'K': 'ᴷ', 'L': 'ᴸ', 'M': 'ᴹ', 
                    'N': 'ᴺ', 'O': 'ᴼ', 'P': 'ᴾ', 'Q': 'Q', 'R': 'ᴿ', 'S': 'ˢ', 'T': 'ᵀ', 
                    'U': 'ᵁ', 'V': 'ⱽ', 'W': 'ᵂ', 'X': 'ˣ', 'Y': 'ʸ', 'Z': 'ᶻ', '+': '⁺', 
                    '-': '⁻', '=': '⁼', '(': '⁽', ')': '⁾'
                };
                
                let result = '';
                for (let i = 0; i < text.length; i++) {
                    const char = text[i];
                    result += superscriptMap[char.toLowerCase()] || char;
                }
                
                return result;
            }
            
            // ИСПРАВЛЕННАЯ ФУНКЦИЯ НЕВИДИМЫХ ЧЕРНИЛ
            function generateInvisibleText(text) {
                // Невидимые символы
                const invisibleChars = ['\u200B', '\u200C', '\u200D', '\u2060', '\uFEFF'];
                let result = '';
                
                for (let i = 0; i < text.length; i++) {
                    if (text[i] === ' ') {
                        result += ' '; // Оставляем пробелы как есть
                    } else {
                        // Заменяем каждый символ на случайный невидимый символ
                        const randomIndex = Math.floor(Math.random() * invisibleChars.length);
                        result += invisibleChars[randomIndex];
                    }
                }
                
                return result;
            }
            
            // Остальной код остается без изменений
            // ...
        });
    </script>
</body>
    </html>
